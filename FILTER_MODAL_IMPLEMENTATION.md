# 商品フィルターモーダル実装

## 概要

商品フィルターモーダルの追加により、サイドバーを整理し、カテゴリー以外のフィルター条件を一つのモーダルに統合しました。

## 実装内容

### 1. 新規作成ファイル

#### `src/components/ProductFilterModal.vue`
- **目的**: 全てのフィルター条件を統合したモーダルコンポーネント
- **機能**:
  - ポーズ数フィルター
  - ソート順選択
  - 価格フィルター
  - キャラクターデザイン衣装オプション
  - 反映ボタン（フィルター適用）
  - リセットボタン（全フィルターをデフォルトに戻す）
  - キャンセルボタン（変更を破棄してモーダルを閉じる）

### 2. 変更ファイル

#### `src/components/CategorySidebar.vue`
- **変更内容**:
  - フィルター関連のセクション（ポーズ数、ソート順、価格、キャラデザ）を削除
  - フィルターボタンを追加
  - アクティブなフィルター数を表示するバッジ機能
  - フィルター概要テキスト表示
  - モバイル対応のフィルターボタン

#### `src/App.vue`
- **変更内容**:
  - `ProductFilterModal`コンポーネントをインポート
  - フィルターモーダルの状態管理を追加
  - `CategorySidebar`のpropsを簡素化（フィルター関連を削除）
  - フィルター適用ロジックを追加（一括更新）
  - モーダル開閉のイベントハンドリング

## 主要機能

### フィルターモーダル
- **一時的な状態管理**: モーダル内でフィルター条件を変更しても、「反映」ボタンを押すまで実際のフィルタリングは実行されない
- **バッチ更新**: 「反映」ボタンクリック時に全フィルターを一括で更新
- **リセット機能**: 全フィルターをデフォルト値に戻す
- **キャンセル機能**: 変更を破棄してモーダルを閉じる

### サイドバーの改善
- **簡素化**: カテゴリー選択とフィルターボタンのみ表示
- **視覚的フィードバック**: アクティブなフィルター数をバッジで表示
- **フィルター概要**: 現在適用中のフィルターを簡潔に表示
- **レスポンシブ対応**: デスクトップとモバイル両方で最適化

## 技術的詳細

### 状態管理
```typescript
// フィルターモーダルの状態
const filterModalState = ref({
  isOpen: false
});

// 一時的なフィルター状態（モーダル内）
const tempFilters = ref<TempFilters>({
  poseCountFilter: string;
  sortOrder: string;
  priceFilter: string;
  characterDesignFee: boolean;
});
```

### イベントフロー
1. ユーザーがサイドバーの「フィルター」ボタンをクリック
2. `openFilterModal()`が呼び出され、モーダルが開く
3. モーダル内で現在のフィルター値が一時的な状態にコピーされる
4. ユーザーがフィルター条件を変更（一時的な状態のみ更新）
5. 「反映」ボタンクリック時に`applyFilters()`が呼び出される
6. 全フィルターが一括でストアに適用される
7. モーダルが閉じる

### レスポンシブデザイン
- **デスクトップ**: 通常サイズのモーダルとボタン
- **モバイル**: コンパクトなフィルターボタンとバッジ表示

## 使用方法

### 開発環境での実行
```bash
npm run dev
```

### 動作確認手順
1. ブラウザで http://localhost:5173 にアクセス
2. サイドバーの「フィルター」ボタンをクリック
3. モーダル内でフィルター条件を変更
4. 「反映」ボタンをクリックしてフィルターを適用
5. 商品リストが更新されることを確認

### テスト項目
- [ ] サイドバーにカテゴリーとフィルターボタンのみ表示される
- [ ] フィルターボタンをクリックするとモーダルが開く
- [ ] モーダル内でフィルター条件を変更できる
- [ ] 「反映」ボタンでフィルターが適用される
- [ ] 「キャンセル」ボタンで変更を破棄してモーダルが閉じる
- [ ] 「リセット」ボタンで全フィルターがデフォルト値に戻る
- [ ] アクティブなフィルター数がボタンにバッジ表示される
- [ ] モバイル表示でも正常に動作する
- [ ] オーバーレイクリックでモーダルが閉じる

## ファイル構成

```
src/
├── components/
│   ├── ProductFilterModal.vue     # 新規作成
│   ├── CategorySidebar.vue        # 変更
│   └── ...
├── App.vue                        # 変更
└── ...
```

## 今後の拡張可能性

- フィルター条件の保存機能
- フィルター履歴機能
- より詳細なフィルター条件の追加
- フィルター条件のURL共有機能

## 注意事項

- フィルターの適用は「反映」ボタンクリック時のみ実行される
- モーダルを閉じる際、未適用の変更は破棄される
- アクティブフィルター数の計算はデフォルト値との比較で行われる